---
title: "Vpliv kršenja predpostavk linearne regresije na njene rezultate"
subtitle: "Seminarska naloga pri predmetu Računsko zahtevne metode"
author: "Anja Žavbi Kunaver in Vesna Zupanc"
date: "11.01.2020"
output:
  beamer_presentation:
    theme: "Warsaw"
    colortheme: "seahorse"
    fig_caption: FALSE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

```{r}
library(dplyr)
library(knitr)
library(kableExtra)
#library("car")
library("multiUS")
library("MASS")
#library(graphics)
```

# Uvod

- Opazujemo širino in pokritost IZ regresijskih koeficientov

- Linearna regresija (lm) in posplošeni linearni modeli (glm)

- Metoda najmanjših kvadratov (OLS) in metoda iterativnega uteženega povprečja najmanjših kvadratov (IWLS)

- Prednost funkcije `glm()`: `family, link`

- Ocenjevanje intervalov zaupanja s funkcijo `confint.default()`

# Predpostavke LR

- linearnost regresijskega modela: $y=\beta_1+\beta_2x_i+u_i$

- ničelna povprečna vrednost $u_i$: $E(u_i)=0$

- homoskedastičnost: $Var(u_i)=E(u_i^2)=\sigma^2$

- odsotnost avtokorelacije: $cov(e_i, e_j|x_i, x_j)=0$ za vsak $i\ne j$

- $Cov(x_2,u)=Cov(x_3,u)=...=Cov(x_k,u)=0$

- število opazovanj mora presegati število ocenjenih parametrov

- $Var(X)$ je končno pozitivno število

- pravilno specificiran regresijski model

- odsotnost multikolinearnosti: $\lambda_1X_1+\lambda_2X_2+...+\lambda_kX_k=0$

- $u_i \sim N(0,\sigma_u^2)$.

# Generiranje podatkov

- formula za generiranje podatkov:

$$y_i = 1 + x_1 + x_2 + 0x_3 + \epsilon_i .$$

- velikost vzorca $n \in \{10, 50, 100, 500, 1000\}$;

- korelacija med pojasnjevalnimi spremenljivkami ($cor \in \{0, 0.3, 0.6, 0.9\}$);

- porazdelitev pojasnjevalnih spremenljivk:
  $X_j \sim Gamma(\delta,5)$, $j=1,2,3$, $\delta=2,5$;

- porazdelitev napak $Gamma(\alpha, 5)$, $\alpha \in \{1, 3, 5\}$;

- v modelu ne upoštevamo vseh neodvisnih spremenljivk: enkrat vključimo vse spremenljivke, enkrat izločimo $X_3$, enkrat pa $X_2$.

# Porazdelitev gama

```{r fig.cap="Porazdelitve ostankov"}
par(mfrow=c(2,2))

x <- seq(0,5,.001)
y <- dgamma(x,1,5)
plot(x,y, main="gamma(1,5)")

y <- dgamma(x,3,5)
plot(x,y, main="gamma(3,5)")

y <- dgamma(x,5,5)
plot(x,y, main="gamma(5,5)")
```

# Analiza variance

Samo za primer vključitve slike.

\begin{center}
  \includegraphics[width=0.8\textwidth]{slika1.png}
  
  \begin{footnotesize}
   Slika 1: Velikost učinka pri analizi variance za pokritost intervala zaupanja
  \end{footnotesize}
\end{center}

# Strukturni modeli

Star slajd, samo za primer, če hočeš vključit tabelo.

\begin{center}
  \begin{footnotesize}
  Tabela 1: Regresijski modeli
  \end{footnotesize}
\end{center}

\begin{center}

```{r}
options(knitr.kable.NA = '')
v1 <- c()
v1[1:6] <- NA
v2 <- c(-0.003, 0.001, -3.289, 0.001, -0.004, -0.074)
v3 <- c(0.076, 0.036, 2.122, 0.034, 0.095, 0.047)
v4 <- c(-0.079, 0.018, -4.468, 0.000, -0.099, -0.089)
v5 <- c()
v5[1:6] <- NA
v6 <- c(-0.003, 0.001, -2.588, 0.010, -0.004, -0.062)
v7 <- c(-0.214, 0.040, -5.362, 0.000, -0.248, -0.124)
v8 <- c(0.113, 0.022, 5.197, 0.000, 0.131, 0.118)
v9 <- c()
v9[1:6] <- NA
v10 <- c(-0.080, 0.043, -1.878, 0.060, -0.080, -0.045)
v11 <- c(0.001, 0.001, 0.864, 0.387, 0.001, 0.020)
stolpci <- c("Estimate", "Std.Err", "z-value", "P(>|z|)", "Std.lv", "Std.all")
tabela <- rbind(v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11)
colnames(tabela) <- stolpci
rownames(tabela) <- c("neobnovljiviViri ~", "  starost","  spol","  klimatske",
                      "obnovljiviViri ~", "  starost","  spol","  klimatske",
                      "klimatske ~", "  spol", "  starost")
kable(tabela, booktabs = F, align = "c") %>% kable_styling(full_width = F, latex_options = c("scale_down"))
```

\end{center}

# Dopolnitev in izboljšave

Na koncu je dobro, da napiševa, kaj bova še dodali/spremenili. Npr:

- Preverjanje vpliva homoskedastičnosti/nelinearne zveze

- 

# Zaključek

Hvala za pozornost!

